var GitHubApiLoader=function(){"use strict";function e(e){var a=this,s=n(this.url.api);s.success(function(t){a.profile=t,n(t.repos_url).success(function(t){a.repos=t,a.url.langs=r(t),e()})}),s.error(function(r,n){var a={message:r.message};t(a,n),e(a)})}function t(e,t){404===t.status&&(e.isWrongUser=!0);var r=t.getResponseHeader("X-RateLimit-Remaining");if(0===Number(r)){var n=t.getResponseHeader("X-RateLimit-Reset");e.resetDate=new Date(1e3*n),e.message=e.message.split("(")[0]}}function r(e){var t=[];for(var r in e)t.push(e[r].languages_url);return t}function n(e){var t=a(e);return{success:function(e){t.addEventListener("load",function(){e&&200===t.status&&e(JSON.parse(t.responseText))})},error:function(e){t.addEventListener("load",function(){if(e&&200!==t.status){var r=JSON.parse(t.responseText);e(r,t)}})}}}function a(e){var t=new XMLHttpRequest;return t.open("GET",e,!0),t.send(),t}var s="https://api.github.com/users/",o=function(e){this.userName=e,this.url={api:s+e,langs:[]},this.error=null};return o.prototype={getData:e,getRepos:function(){return this.repos},getProfile:function(){return this.profile},getURLs:function(){return this.url}},o}(),DOMOperator=function(){"use strict";function e(e){for(;e.hasChildNodes();)e.removeChild(e.firstChild)}function t(e,t){var r=document.createElement("div");if(r.className="error",r.innerHTML="<span>"+e.message+"</span>",e.isWrongUser&&(r.innerHTML="<span>Not found user: "+t+"</span>"),e.resetDate){var n=e.resetDate.getMinutes()-(new Date).getMinutes();n=n<0?60+n:n,r.innerHTML+='<span class="remain">Come back after '+n+" minutes</span>"}return r}function r(e){function t(e,t){t.forEach(function(t){e.appendChild(t)})}function r(e){var r=document.createElement("div");return r.classList.add("profile"),t(r,e),r}function n(e,t){var r=document.createElement("a");return r.href=e,r.className="name",r.appendChild(document.createTextNode(t)),r}function a(e){var t=document.createElement("img");return t.src=e,t.className="avatar",t}function s(e,t){var r=document.createElement("a");return r.href=t,r.className="follow-button",r.innerHTML="Follow @"+e,r}function o(e,t){return c=document.createElement("span"),c.href=e,c.className="followers",c.innerHTML=t,c}function i(e){var r=document.createElement("div");return r.className="followMe",t(r,e),r}var u=s(e.login,e.html_url),c=o(e.followers_url,e.followers),l=i([u,c]),p=a(e.avatar_url),f=n(e.html_url,e.name);return r([p,f,l])}function n(e){var t=[];for(var r in e)t.push([r,e[r]]);t.sort(function(e,t){return t[1]-e[1]});var n=document.createElement("ul");n.className="languages";for(var a=0;a<3&&t[a];a++)n.innerHTML+="<li>"+t[a][0]+"</li>";return n}function a(e){var t=document.createElement("span");return t.className="header",t.appendChild(document.createTextNode(e+" repositories")),t}function s(e,t,r){e.sort(function(e,r){return"stars"===t?r.stargazers_count-e.stargazers_count:new Date(r.updated_at).getTime()-new Date(e.updated_at).getTime()});var n=document.createElement("div");n.className="repos";for(var a=0;a<r&&e[a];a++){var s=new Date(e[a].updated_at),o=document.createElement("a");o.href=e[a].html_url,o.title=e[a].description,o.innerHTML+='<span class="repo-name">'+e[a].name+"</span>",o.innerHTML+='<span class="updated">Updated: '+s.toLocaleDateString()+"</span>",o.innerHTML+='<span class="star">'+e[a].stargazers_count+"</span>",n.appendChild(o)}return n}return{clearChildren:e,createError:t,createProfile:r,createTopLanguages:n,createReposHeader:a,createReposList:s}}(),GitHubCard=function(){"use strict";function e(e){var t=new GitHubApiLoader(s),r=this;t.getData(function(n){r.profileData=t.getProfile(),r.repos=t.getRepos(),r.url=t.getURLs(),r.render(e,n)}),this.$template.className="gh-profile-card"}function t(e){var t={};return e.forEach(function(e){var r=0;for(var n in e)r+=e[n]||0,t[n]=t[n]||0,t[n]+=e[n]/(1*r)}),t}function r(e){function r(r){var s=r.target.responseText,o=JSON.parse(s);if(n.push(o),n.length===a.length){var i=t(n);e(i)}}var n=[],a=this.url.langs;a.forEach(function(e){var t=new XMLHttpRequest;t.addEventListener("load",r,!1),t.open("GET",e,!0),t.send(null)})}function n(e,t){var r=this.$template,n=this.repos;if(DOMOperator.clearChildren(r),t){var a=DOMOperator.createError(t,s);return void r.appendChild(a)}var o=DOMOperator.createProfile(this.profileData);if(this.getTopLanguages(function(e){o.appendChild(DOMOperator.createTopLanguages(e))}),r.appendChild(o),e.maxRepos>0){var i=DOMOperator.createReposHeader(e.reposHeaderText),u=DOMOperator.createReposList(n,e.sortBy,e.maxRepos);u.insertBefore(i,u.firstChild),r.appendChild(u)}}function a(e){e=o(e),this.render(e)}var s,o=function(e){var t={template:"#github-card",sortBy:"stars",reposHeaderText:"Most starred",maxRepos:5,githubIcon:!1};if(!e)return t;for(var r in t)e[r]=e[r]||t[r];return e},i=function(e){e=o(e),this.$template=document.querySelector(e.template),s=e.userName||this.$template.dataset.username,this.profileData=null,this.repos={},this.init(e)};return i.prototype={init:e,getTopLanguages:r,render:n,refresh:a},i}();